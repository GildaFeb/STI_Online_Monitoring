@model STI_Online_Monitoring.Models.GuestModel

@{
    ViewBag.Title = "Welcome";
}

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script src="~/Scripts/jquery-1.9.1.js"></script>
    <script src="~/Scripts/bootstrap.js"></script>
    <link href="~/Content/bootstrap.css" rel="stylesheet" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="" />
    <meta name="author" content="" />

    <!-- BOOTSTRAP CORE STYLE  -->
    <link href="../../Content/assets/css/bootstrap.css" rel="stylesheet" />
    <!-- FONT AWESOME STYLE  -->
    <link href="../../Content/assets/css/font-awesome.css" rel="stylesheet" />
    <link href="../../Content/CSS/GuestPage.css" rel="stylesheet" />
    <!-- CUSTOM STYLE  -->
    <link href="../../Content/assets/css/style.css" rel="stylesheet" />

    <link href="../../Content/assets/css/style.css" rel="stylesheet" />
    <!-- GOOGLE FONT -->
    <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css' />

</head>
<body style="background-color: #003366">
    <div class="center">
        <header class="navbar navbar-inverse set-radius-zero" style=" background-color: yellow; margin-top:-50px; font-style:oblique; ">
        </header>
        <!-- MENU SECTION END-->
        <div style="overflow:auto; " class="secondDiv wow bounceInUp">
            <div class="menu" style="margin-left:2%">
                <div class="menuitem" style="background-color: #003366; "><h4 class="header-line" style="font-size: x-large; color: #fff200; background-color: #003366;  font-weight:bold ">GUEST DASHBOARD</h4></div>
                <div class="menuitem" style="margin-top:-3%">
                    <div class="buttons">
                        <a data-toggle="modal" data-target="#Information" class="effect effect01"> My Information</a>
                    </div>
                </div>
                <div class="menuitem" style="margin-top:-3%">
                    <div class="buttons">
                        <a data-toggle="modal" data-target="#myModal" class="effect effect01" onclick="GetConfirmation(@Session["GuestID"]);"> Request to Visit</a>
                    </div>
                </div>

                <div class="menuitem" style="margin-top:-2%">
                    <div class="buttons2">
                        <div class="container1">
                            <span class="btn2 effect02">@Html.ActionLink("LOG OUT", "Logout", "LogIn", new { @style = "color: white; font-weight:500; text-decoration:none" })</span>
                        </div>
                    </div>
                </div>
                <div class="linkDiv">
                    <ul>
                        <li>
                            <a class="facebook" href="https://www.facebook.com/sjdelmonte.sti.edu">
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <i class="fa fa-facebook" aria-hidden="true"></i>
                            </a>
                        </li>
                        <li>
                            <a class="twitter" href="https://twitter.com/sticollege">
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <i class="fa fa-twitter" aria-hidden="true"></i>
                            </a>
                        </li>
                        <li>
                            <a class="instagram" href="recruitment@sjdelmonte.sti.edu">
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <i class="glyphicon-book" aria-hidden="true"></i>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="main wow bounceInUp" >
                <div class="content-wrapper">
                    <div class="container">
                        <div class="row pad-botm">
                            <div class="col-md-12">

                            </div>

                        </div>

                        <div class="container">
                            <div class="container">
                                <div class="col-1" id="spacer"></div>
                                <div class="col-11" style="float:left; margin-bottom:2%">
                                    <a href="welcome" style="text-decoration:none;  color:white; font-size: 30px; font-weight: bolder;" class="menu-top-active">Welcome @Session["Email"].ToString()</a>
                                </div>
                            </div>
                            <div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
                                <!-- Indicators -->
                                <ol class="carousel-indicators">
                                    <li data-target="#carousel-example-generic" data-slide-to="0" class="active"></li>
                                    <li data-target="#carousel-example-generic" data-slide-to="1"></li>
                                    <li data-target="#carousel-example-generic" data-slide-to="2"></li>
                                </ol>

                                <!-- Wrapper for slides -->
                                <div class="carousel-inner" role="listbox">
                                    <div class="item active">
                                        <img src="https://www.sti.edu/images/shsbanner2020-mob.png">
                                    </div>

                                    <div class="item">
                                        <img src="https://www.sti.edu/images/2020colbanner-mob.png">

                                    </div>

                                    <div class="item">
                                        <img src="https://www.sti.edu/img/2018-generic-fbpreview.jpg">
                                    </div>
                                </div>

                                <!-- Controls -->
                                <a class="left carousel-control" href="#carousel-example-generic" role="button" data-slide="prev">
                                    <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                                    <span class="sr-only">Previous</span>
                                </a>

                                <a class="right carousel-control" href="#carousel-example-generic" role="button" data-slide="next">
                                    <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                                    <span class="sr-only">Next</span>
                                </a>
                            </div>
                        </div>

                        <!-- ****************************************  MY INFORMATION: POP UP   ******************************-->
                        <div class="modal fade" id="Information" role="dialog">
                            <div class="modal-dialog">
                                <!-- Modal content-->
                                <div class="modal-content">
                                    <div class="modal-header" style="background-color:#003366; color:white">
                                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                                    </div>
                                    <div class="row" style="margin:2%">
                                        <div class="col-md-12 col-sm-12 col-xs-12">
                                            <div class="panel panel-success">
                                                <div class="panel-heading">
                                                    YOUR INFORMATION
                                                </div>
                                                <div class="panel-body">
                                                    <div class="table-responsive row" style="margin:1%">
                                                        @if (Model != null)
                                                        {
                                                            if (Model.Guestinfo.Count > 0)
                                                            {
                                                                <table class="table table-striped table-bordered table-hover">
                                                                    <thead>
                                                                        @foreach (var item in Model.Guestinfo)
                                                                        {
                                                                            <tr><td>Guest Number</td><td>@Html.DisplayFor(modelitem => item.GuestID)</td> </tr>
                                                                            <tr><td>First Name</td><td>@Html.DisplayFor(modelitem => item.FirstName)</td></tr>
                                                                            <tr><td>Last Name</td><td>@Html.DisplayFor(modelitem => item.LasttName)</td></tr>
                                                                            <tr><td>Middle Name</td><td>@Html.DisplayFor(modelitem => item.MiddleName)</td></tr>
                                                                            <tr><td>Suffix</td><td>@Html.DisplayFor(modelitem => item.Suffix)</td> </tr>
                                                                            <tr><td>Email</td><td>@Html.DisplayFor(modelitem => item.Email)</td></tr>
                                                                            <tr><td>Contact Number</td><td>@Html.DisplayFor(modelitem => item.ContactNumber)</td></tr>
                                                                            <tr><td>Address</td><td>@Html.DisplayFor(modelitem => item.Address)</td></tr>
                                                                            <tr><td>Gender</td><td>@Html.DisplayFor(modelitem => item.Gender)</td></tr>
                                                                            <tr><td>Password</td><td>@Html.DisplayFor(modelitem => item.Password, new { Type = "Password" })</td></tr>
                                                                            <tr>
                                                                                <td>
                                                                                    <button data type="button" class="btn btn-primary" onclick="EditInfo(@item.GuestID);"> Edit </button>
                                                                                </td>
                                                                            </tr>

                                                                        }
                                                                    </thead>
                                                                </table>
                                                            }
                                                            else
                                                            {
                                                                <b>No Details Found.</b>
                                                            }
                                                        }
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                    <div class="modal-footer" style="background-color:#003366; color:white">
                                        <button type="button" class="btn btn-warning" data-dismiss="modal">Close</button>
                                    </div>
                                </div>

                            </div>
                        </div>
                        <!-- **************************************** EDIT MY INFORMATION: POP UP   ******************************-->
                        <div data-toggle="modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" id="EditInformation">
                            <div class="modal-dialog">
                                <!-- Modal content-->
                                <div class="modal-content">
                                    <div class="modal-header" style="background-color:#003366; color:white">
                                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                                    </div>
                                    <div class="row" style="margin-left:2%">
                                        <div class="col-md-12 col-sm-12 col-xs-12">
                                            <div class="panel panel-success">
                                                <div class="panel-body">
                                                    <div class="table-responsive">

                                                        <form>
                                                            <div class="form-group">
                                                                <label for="GuestID">GuestID</label>
                                                                <input type="text" class="form-control" id="GuestID" disabled="disabled" />
                                                            </div>
                                                            <div class="form-group">
                                                                <label for="LastName">Last Name</label>
                                                                <input type="text" class="form-control" id="LastName" disabled="disabled" />
                                                            </div>
                                                            <div class="form-group">
                                                                <label for="FirstName">First Name</label>
                                                                <input type="text" class="form-control" id="FirstName" disabled="disabled" />
                                                            </div>
                                                            <div class="form-group">
                                                                <label for="MiddleName">Middle Name</label>
                                                                <input type="text" class="form-control" id="MiddleName" disabled="disabled" />
                                                            </div>
                                                            <div class="form-group">
                                                                <label for="Suffix">Suffix</label>
                                                                <input type="text" class="form-control" id="Suffix" disabled="disabled" />
                                                            </div>
                                                            <div class="form-group">
                                                                <label for="Gender">Gender</label>
                                                                <input type="text" class="form-control" id="Gender" disabled="disabled" />
                                                            </div>
                                                            <div class="form-group">
                                                                <label for="Email">Email</label>
                                                                <input type="text" class="form-control" id="Email" disabled="disabled" />
                                                            </div>
                                                            <div class="form-group">
                                                                <label for="ContactNumber">Contact Number</label>
                                                                <input type="text" class="form-control" id="ContactNumber" />
                                                            </div>
                                                            <div class="form-group">
                                                                <label for="Address">Address</label>
                                                                <input type="text" class="form-control" id="Address" />
                                                            </div>
                                                            <div class="form-group">
                                                                <label for="password">Password</label>
                                                                <input type="password" class="form-control" id="password" />
                                                            </div>
                                                            <div class="form-group">
                                                                <label for="cpassword">Confirm Password</label>
                                                                <input type="password" class="form-control" id="cpassword" />
                                                            </div>
                                                            <div class="form-group">
                                                                <label id="alert" style="color:red"> </label>
                                                            </div>
                                                            <button type="button" class="btn btn-primary" id="btnUpdate" onclick="Update()">Update</button>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                    <div class="modal-footer" style="background-color:#003366; color:white">
                                        <button type="button" class="btn btn-warning" data-dismiss="modal">Close</button>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>

                </div>
            </div>

        </div>
        <!--MODAL -->
        <div class="modal fade" id="myModal" role="dialog">
            <div class="modal-dialog">
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header" style="background-color:#003366; color:white">
                        <label style="margin-left: 2%; font-size:20px"> Guest Confirmation</label>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    @using (Html.BeginForm("Welcome", "LogIn", FormMethod.Post))
                    {
                        @Html.AntiForgeryToken()

                        <div class="form-horizontal" style=" margin-left:10%">
                            <h4 style="color:#003366; font-weight:bold; margin-left:2%; margin-top: 2%">
                                @Html.DisplayFor(Model => Model.LasttName, new { @class = "control-label col-md-2",  disabled = "disabled" })
                            </h4>
                            <hr />

                            <div class="form-group">
                                @Html.LabelFor(Model => Model.GuestID, htmlAttributes: new { @class = "control-label col-md-2" })
                                <div class="col-md-10">
                                    @Html.EditorFor(Modelm => Model.GuestID, new { htmlAttributes = new { @class = "form-control" } })
                                    @Html.ValidationMessageFor(Model => Model.GuestID, "", new { @class = "text-danger", })
                                </div>
                            </div>
                            <div class="form-group">
                                @Html.LabelFor(Model => Model.Password, htmlAttributes: new { @class = "control-label col-md-2" })
                                <div class="col-md-10">
                                    @Html.EditorFor(Modelm => Model.Password, new { htmlAttributes = new { @class = "form-control" } })
                                    @Html.ValidationMessageFor(Model => Model.Password, "", new { @class = "text-danger", })
                                </div>
                            </div>
                            <h1>@Html.ViewData["Message"]</h1>
                            <div class="form-group">
                                <div class="col-md-offset-2 col-md-8">
                                    <input value="Confirm" type="submit" style="color:white" class="btn btn-primary" onclick="location.href='@Url.Action("Confirm", "Confirm")'" />
                                </div>
                            </div>

                        </div>
                    }
                    <div class="modal-footer" style="background-color:#003366; color:white">
                        <button type="button" class="btn btn-warning" data-dismiss="modal">Close</button>
                    </div>
                </div>

            </div>
        </div>
        <footer id="footer" style="margin-top:5%">
            <div id="footer">
                <div class="footer-top">
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-6 col-md-8 footer-contact">
                                <h4><i class="ion-ios-location-outline"></i>  Address</h4>
                                <p>
                                    STI Academic Center, Quirino Highway, Tungkong Mangga, San Jose Del Monte City, 3023 Bulacan
                                </p>
                            </div>
                            <div class="col-lg-2 col-md-6 footer-links">
                                <h4> <i class="ion-ios-email-outline"></i>  Email</h4>
                                <p>sjdelmonte.sti.edu</p>
                            </div>
                            <div class="col-lg-3 col-md-6 footer-info">
                                <h4><i class="ion-ios-telephone-outline"></i> Phone</h4>
                                <p>044-7943657 / 044-7616017</p>
                            </div>

                        </div>
                    </div>
                </div>
                <div class="container">
                    <div class="copyright">
                        &copy; Copyright <strong>STI College San Jose Del Monte Online Monitoring</strong>. All Rights Reserved 2021
                    </div>
                </div>
            </div>
        </footer>
    </div>
    <!-- #footer -->
    <script src="../../Content/assets/js/jquery-1.10.2.js"></script>
    <!-- BOOTSTRAP SCRIPTS  -->
    <script src="../../Content/assets/js/bootstrap.js"></script>
    <!-- CUSTOM SCRIPTS  -->
    <script src="../../Content/assets/js/custom.js">

    </script>
    <!--==========================
      Footer
    ============================-->
    <script>
        function EditInfo(idGuest) {

            $.ajax({
                url: "/LogIn/GetbyID/" + idGuest,
                typr: "GET",
                contentType: "application/json;charset=UTF-8",
                dataType: "json",
                success: function (result) {
                    $('#GuestID').val(result.GuestID);
                    $('#ContactNumber').val(result.ContactNumber);
                    $('#Address').val(result.Address);
                    $('#password').val(result.Password);
                    $('#LastName').val(result.LasttName);
                    $('#FirstName').val(result.FirstName);
                    $('#MiddleName').val(result.MiddleName);
                    $('#Suffix').val(result.Suffix);
                    $('#Gender').val(result.Gender);
                    $('#Email').val(result.Email);
                    $('#EditInformation').modal('show');
                    $('#btnUpdate').show();
                },
                error: function (errormessage) {
                    alert(errormessage.responseText);
                }
            });
            return false;
        }



        function Update() {
            var res = validate();
            if (res == false) {
                return false;
            }
            var GuestObj = {
                GuestID: $('#GuestID').val(),
                ContactNumber: $('#ContactNumber').val(),
                Age: $('#Age').val(),
                Address: $('#Address').val(),
                Password: $('#password').val(),
                LasttName: $('#LastName').val(),
                FirstName: $('#FirstName').val(),
                MiddleName: $('#MiddleName').val(),
                Suffix: $('#Suffix').val(),
                Gender: $('#Gender').val(),
                Email: $('#Email').val()
            };
            var ans = confirm("Update Guest Information. Do you want to Continue?");
            if (ans) {
                $.ajax({
                    url: "/LogIn/Update",
                    data: JSON.stringify(GuestObj),
                    type: "POST",
                    contentType: "application/json;charset=utf-8",
                    dataType: "json",

                    success: function (result) {
                        alert("Information Successfully Updated");
                        $('#EditInformation').modal('hide');
                        $('#Information').modal('hide');
                        $('#GuestID').val("");
                        $('#ContactNumber').val("");
                        $('#Address').val("");
                        $('#password').val("");
                        $('#LastName').val("");
                        $('#FirstName').val("");
                        $('#MiddleName').val("");
                        $('#Suffix').val("");
                        $('#Gender').val("")
                        $('#Email').val("")

                       
                    },
                    error: function (errormessage) {
                        alert(errormessage.responseText);
                    }
                });

            }
            else {
                $('#EditInformation').modal('hide');
            }
        }

        $(document).ready(function () {
            $("#cpassword").keyup(validate);
            $("#password").keyup(validate);
            $("#ContactNumber").keyup(validate);
            $("#Address").keyup(validate);
            $("#cpassword").keyup(validate);
        });


        function validate() {
            var password1 = $("#password").val();
            var password2 = $("#cpassword").val();

            if (password1 == password2) {
                $("#alert").text("Password matched");
                $('#alert').css('color', 'green');
            }
            else {
                $("#alert").text("Not matched");
            }
            var isValid = true;
            if ($('#password').val().trim() == "") {
                $('#password').css('border-color', 'Red');
                isValid = false;
            }
            else {
                $('#password').css('border-color', 'lightgrey');
            }
            if ($('#Address').val().trim() == "") {
                $('#Address').css('border-color', 'Red');
                isValid = false;
            }
            else {
                $('#Address').css('border-color', 'lightgrey');
            }
            if ($('#ContactNumber').val().trim() == "") {
                $('#ContactNumber').css('border-color', '');
                isValid = false;
            }
            else {
                $('#ContactNumber').css('border-color', 'lightgrey');
            }
            if ($('#cpassword').val().trim() == "") {
                $('#cpassword').css('border-color', 'red');
                isValid = false;
            }
            else {
                $('#cpassword').css('border-color', 'lightgrey');
            }
        }

        //===========================================
        //============ GET CONFIRMATION =============
        //===========================================

        function getConfirmation(id) {

            $.ajax({
                url: "/LogIn/GetbyID/" + id,
                typr: "GET",
                contentType: "application/json;charset=UTF-8",
                dataType: "json",
                success: function (result) {
                    $('#idGuest').val(GuestID);


                    $('#MyModal').modal('show');
                    $('#btnConfirm').show();
                },
                error: function (errormessage) {
                    alert(errormessage.responseText);
                }
            });
            return false;
        } 
    </script>
</body>

</html>